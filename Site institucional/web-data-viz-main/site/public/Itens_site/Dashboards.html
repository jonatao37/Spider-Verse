<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Spiderverse | Dashboards</title>

    <script src="./js/funcoes.js"></script>

    <link rel="icon" href="../assets/img/logo3.png">
    <link rel="stylesheet" href="../css/dashboards-style.css">
    <link rel="preconnect" href="https://fonts.gstatic.com">
</head>

<body onload="obterDadosGrafico()">

    <div class="header">
        <div id="menu" class="hero-container">
            <a href="Home.html"><img class="hero glitch layers" src="../assets/img/logo3.png"></a>
            <h2 class="hero glitch layers"><span>Spider-Verse</span></h2>
            <ul class="NavBar">
                <li><a href="Home.html">Home</a></li>
                <li><a href="Sobre os Personagens.html">Personagens</a></li>
                <li><a href="Quiz.html">Quiz</a></li>
                <li><a class="underline" href="Dashboards.html">Dashboards</a></li>
                <li class="sair"><a href="../index.html">Logout</a></li>
                <div class="hello">
                    <h3>Olá, <span id="b_usuario">usuário</span>!</h3>
                </div>
        </div>
    </div>

    <div class="banner">
        <div class="banner-container">
            
            <div class="grafico">
                <canvas id="myChart"></canvas>
            </div>
    
            <div class="grafico1">
                <canvas id="myChart1"></canvas>
            </div>


        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

</body>

</html>

<script>
    b_usuario.innerHTML = sessionStorage.NOME_USUARIO;

    function obterDadosGrafico(idQuiz) {

fetch(`/grafico/ultimas/`, { cache: 'no-store' }).then(function (response) {
  if (response.ok) {
    response.json().then(function (resposta) {
      console.log(`Dados recebidos: ${JSON.stringify(resposta)}`);
      // resposta.reverse();

      plotarDadosGrafico(resposta);
    });
  } else {
    console.error('Nenhum dado encontrado ou erro na API');
  }
})
  .catch(function (error) {
    console.error(`Erro na obtenção dos dados p/ gráfico: ${error.message}`);
  });
}

function plotarDadosGrafico(dados) {

var data = [];
var labels = [];
var cores = ['#ff0000','#fcce05','#9905fc','#0838d8','#24a518','#3fcbdd','#e953ab','#ffae00','#00a2ff','#ff0055'];

for (var i = 0; i < dados.length; i++) {
  data.push(dados[i].quantidade);        
  labels.push(`${dados[i].personagem} Personagem`);
}  
// ${plural ? "pessoas" : "pessoa"}

const ctx = document.getElementById('myChart');
new Chart(ctx, {
  type: 'pie',
  data: {
    labels,
    datasets: [{
      data,
      fill: false,
      backgroundColor: cores,
      // borderColor: 'white',
      borderWidth: 1,
      tension: 0.1
    }]
  },
  options: {
    options: {
      scales: {} // Define as escalas vazias
    }
  }
});
}

    const ctx = document.getElementById('myChart1');

    new Chart(ctx, {
        type: 'radar',
        data: {
            labels: [
                'Eating',
                'Drinking',
                'Sleeping',
                'Designing',
                'Coding',
                'Cycling',
                'Running'
            ],
            datasets: [{
                label: 'My First Dataset',
                data: [
                    65,
                    59,
                    90,
                    81,
                    56,
                    55,
                    40],
                fill: true,
                backgroundColor: 'rgba(255, 99, 132, 0.2)',
                borderColor: 'rgb(255, 99, 132)',
                pointBackgroundColor: 'rgb(255, 99, 132)',
                pointBorderColor: '#fff',
                pointHoverBackgroundColor: '#fff',
                pointHoverBorderColor: 'rgb(255, 99, 132)'
            }, {
                label: 'My Second Dataset',
                data: [
                    28,
                    48,
                    40,
                    19,
                    96,
                    27,
                    100],
                fill: true,
                backgroundColor: 'rgba(54, 162, 235, 0.2)',
                borderColor: 'rgb(54, 162, 235)',
                pointBackgroundColor: 'rgb(54, 162, 235)',
                pointBorderColor: '#fff',
                pointHoverBackgroundColor: '#fff',
                pointHoverBorderColor: 'rgb(54, 162, 235)'
            }]
        }
    });


</script>